<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Roc</title>
    <description></description>
    <link>http://localhost:4000/</link>
    <atom:link href="http://localhost:4000/feed.xml" rel="self" type="application/rss+xml"/>
    <pubDate>Fri, 14 Apr 2017 16:36:55 +0800</pubDate>
    <lastBuildDate>Fri, 14 Apr 2017 16:36:55 +0800</lastBuildDate>
    <generator>Jekyll v3.4.3</generator>
    
      <item>
        <title>Ubuntu安装Zookeeper</title>
        <description>&lt;ul id=&quot;markdown-toc&quot;&gt;
  &lt;li&gt;&lt;a href=&quot;#zookeeper环境安装&quot; id=&quot;markdown-toc-zookeeper环境安装&quot;&gt;Zookeeper环境安装&lt;/a&gt;    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;#创建data和log目录&quot; id=&quot;markdown-toc-创建data和log目录&quot;&gt;创建data和log目录&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#修改配置文件&quot; id=&quot;markdown-toc-修改配置文件&quot;&gt;修改配置文件&lt;/a&gt;        &lt;ul&gt;
          &lt;li&gt;&lt;a href=&quot;#从命名配置文件&quot; id=&quot;markdown-toc-从命名配置文件&quot;&gt;从命名配置文件&lt;/a&gt;&lt;/li&gt;
          &lt;li&gt;&lt;a href=&quot;#修改默认配置项&quot; id=&quot;markdown-toc-修改默认配置项&quot;&gt;修改默认配置项&lt;/a&gt;&lt;/li&gt;
          &lt;li&gt;&lt;a href=&quot;#添加集群通信配置项&quot; id=&quot;markdown-toc-添加集群通信配置项&quot;&gt;添加集群通信配置项&lt;/a&gt;&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#启动服务&quot; id=&quot;markdown-toc-启动服务&quot;&gt;启动服务&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#zookeeper环境安装docker&quot; id=&quot;markdown-toc-zookeeper环境安装docker&quot;&gt;Zookeeper环境安装(Docker)&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h1 id=&quot;zookeeper环境安装&quot;&gt;Zookeeper环境安装&lt;/h1&gt;

Zookeeper配置服务器集群遵循2N+1的原则,即奇数台服务器原则(因为半数服务器挂掉即停掉所有服务)

&lt;a href=&quot;http://apache.01link.hk/zookeeper/stable/&quot;&gt;打开最新稳定版本包下载地址&lt;/a&gt;
选中需要下载的包右键获取连接地址,通过命令行下载并解压如下:

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;gp&quot;&gt;$ &lt;/span&gt;wget http://apache.01link.hk/zookeeper/stable/zookeeper-3.4.10.tar.gzls

&lt;span class=&quot;gp&quot;&gt;$ &lt;/span&gt;tar -zxvf zookeeper-3.4.10.tar.gz

&lt;span class=&quot;nb&quot;&gt;pwd&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;h5 id=&quot;创建data和log目录&quot;&gt;创建data和log目录&lt;/h5&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;gp&quot;&gt;$ &lt;/span&gt;mkdir zkdata
&lt;span class=&quot;gp&quot;&gt;$ &lt;/span&gt;mkdir zkdataLog
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
进入配置文件夹

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;gp&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cd &lt;/span&gt;zookeeper-3.4.10/conf
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;h5 id=&quot;修改配置文件&quot;&gt;修改配置文件&lt;/h5&gt;
拷贝并从新命名官方提供的样本文件zoo_sample.cfg为zoo.cfg

&lt;h6 id=&quot;从命名配置文件&quot;&gt;从命名配置文件&lt;/h6&gt;
&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;gp&quot;&gt;$ &lt;/span&gt;cp zoo_sample.cfg zoo.cfg
&lt;span class=&quot;gp&quot;&gt;$ &lt;/span&gt;vi zoo.cfg
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# The number of milliseconds of each tick&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;tickTime&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;2000
&lt;span class=&quot;c&quot;&gt;# The number of ticks that the initial&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# synchronization phase can take&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;initLimit&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;10
&lt;span class=&quot;c&quot;&gt;# The number of ticks that can pass between&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# sending a request and getting an acknowledgement&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;syncLimit&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;5
&lt;span class=&quot;c&quot;&gt;# the directory where the snapshot is stored.&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# do not use /tmp for storage, /tmp here is just&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# example sakes.&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;dataDir&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/tmp/zookeeper
&lt;span class=&quot;c&quot;&gt;# the port at which the clients will connect&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;clientPort&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;2181
&lt;span class=&quot;c&quot;&gt;# the maximum number of client connections.&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# increase this if you need to handle more clients&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#maxClientCnxns=60&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# Be sure to read the maintenance section of the&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# administrator guide before turning on autopurge.&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# http://zookeeper.apache.org/doc/current/zookeeperAdmin.html#sc_maintenance&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# The number of snapshots to retain in dataDir&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#autopurge.snapRetainCount=3&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# Purge task interval in hours&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# Set to &quot;0&quot; to disable auto purge feature&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#autopurge.purgeInterval=1&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;h6 id=&quot;修改默认配置项&quot;&gt;修改默认配置项&lt;/h6&gt;
&lt;ul&gt;
  &lt;li&gt;修改&lt;code class=&quot;highlighter-rouge&quot;&gt;dataDir&lt;/code&gt;为我们刚刚创建的zkdata路径(快照日志目录)&lt;/li&gt;
  &lt;li&gt;添加新的配置项&lt;code class=&quot;highlighter-rouge&quot;&gt;dataLogDir&lt;/code&gt;在&lt;code class=&quot;highlighter-rouge&quot;&gt;dataDir&lt;/code&gt;下方,路径为刚刚创建的&lt;code class=&quot;highlighter-rouge&quot;&gt;zkdataLog&lt;/code&gt;路径.(事务目录,如果不配置讲放入到&lt;code class=&quot;highlighter-rouge&quot;&gt;dataDir&lt;/code&gt;目录,造成性能下降)&lt;/li&gt;
  &lt;li&gt;修改端口为任意不冲突端口
如下
    &lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;dataDir&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/home/roc/fabric/zkdata
&lt;span class=&quot;nv&quot;&gt;dataLogDir&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/home/roc/fabric/zkdataLog
&lt;span class=&quot;nv&quot;&gt;clientPort&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;21811
&lt;/code&gt;&lt;/pre&gt;
    &lt;/div&gt;
    &lt;h6 id=&quot;添加集群通信配置项&quot;&gt;添加集群通信配置项&lt;/h6&gt;
    &lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;#机器标识为1的ip地址,跟随者端口默认2888:选举端口3888&lt;/span&gt;
server.1&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;192.168.186.40:2888:3888
server.2&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;192.168.186.41:2888:3888
server.3&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;192.168.186.42:2888:3888
&lt;/code&gt;&lt;/pre&gt;
    &lt;/div&gt;
    在对应服务器中,转到&lt;code class=&quot;highlighter-rouge&quot;&gt;dataDir&lt;/code&gt;目录,创建一个&lt;strong&gt;对应的&lt;/strong&gt;标识文件&lt;code class=&quot;highlighter-rouge&quot;&gt;myid&lt;/code&gt;,内容为“1”(可以命名其他标识，为了便于记忆我们用数字编号作为标识)
    &lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;gp&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; /home/roc/fabric/zkdata
&lt;span class=&quot;gp&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;1&quot;&lt;/span&gt; &amp;gt; myid
&lt;/code&gt;&lt;/pre&gt;
    &lt;/div&gt;
    &lt;blockquote&gt;
      在例子中我配置了三台服务器,那么我需要在这三台服务器上面分别执行上面操作,为了方便可以直接copy配置文件,但是需要手动创建对应标识文件&lt;code class=&quot;highlighter-rouge&quot;&gt;myid&lt;/code&gt;文件
    &lt;/blockquote&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h5 id=&quot;启动服务&quot;&gt;启动服务&lt;/h5&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;#进入`bin`目录,执行脚本zkServer.sh&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; /home/roc/fabric/zookeeper-3.4.10/bin
&lt;span class=&quot;c&quot;&gt;#查看命令&lt;/span&gt;
./zkServer.sh

ZooKeeper JMX enabled by default
Using config: /home/roc/fabric/zookeeper-3.4.10/bin/../conf/zoo.cfg
Usage: ./zkServer.sh &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;start|start-foreground|stop|restart|status|upgrade|print-cmd&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

./zkServer.sh start

ZooKeeper JMX enabled by default
Using config: /home/roc/fabric/zookeeper-3.4.10/bin/../conf/zoo.cfg
Starting zookeeper ... STARTED

&lt;span class=&quot;c&quot;&gt;#查看集群状态&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;blockquote&gt;
  对其他服务器做同样的操作
&lt;/blockquote&gt;

&lt;h1 id=&quot;zookeeper环境安装docker&quot;&gt;Zookeeper环境安装(Docker)&lt;/h1&gt;
&lt;a href=&quot;https://sunnyroc.github.io/2015/06/01/Ubuntu-install-docker/&quot;&gt;安装docker&lt;/a&gt;
&lt;a href=&quot;https://hub.docker.com/r/library/zookeeper/&quot;&gt;Zookeeper&lt;/a&gt;
&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;gp&quot;&gt;$ &lt;/span&gt;sudo docker pull zookeeper
&lt;span class=&quot;c&quot;&gt;#进入zookeeper安装目录，创建docker-compose.yml配置文件&lt;/span&gt;
&lt;span class=&quot;gp&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; /home/roc/fabric/zookeeper-3.4.10
&lt;span class=&quot;gp&quot;&gt;$ &lt;/span&gt;touch docker-compose.yml
&lt;span class=&quot;gp&quot;&gt;$ &lt;/span&gt;vim docker-compose.yml
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;version: &lt;span class=&quot;s1&quot;&gt;'2'&lt;/span&gt;
services:
    zoo1:
        image: zookeeper
        restart: always
        ports:
            - 2181:2181
        environment:
            ZOO_MY_ID: 1
            ZOO_SERVERS: server.1&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;zoo1:2888:3888 server.2&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;zoo2:2888:3888 server.3&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;zoo3:2888:3888

    zoo2:
        image: zookeeper
        restart: always
        ports:
            - 2182:2181
        environment:
            ZOO_MY_ID: 2
            ZOO_SERVERS: server.1&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;zoo1:2888:3888 server.2&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;zoo2:2888:3888 server.3&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;zoo3:2888:3888

    zoo3:
        image: zookeeper
        restart: always
        ports:
            - 2183:2181
        environment:
            ZOO_MY_ID: 3
            ZOO_SERVERS: server.1&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;zoo1:2888:3888 server.2&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;zoo2:2888:3888 server.3&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;zoo3:2888:3888

&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;blockquote&gt;
  上面配置了3个服务器,客户端端口为2888，追谁者端口为3888
&lt;/blockquote&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;#后台执行compose,为了避免与其他项目混淆,我们可以使用COMPOSE_PROJECT_NAME=project_name作为命令行前缀来区分不同的compose服务&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#例如:COMPOSE_PROJECT_NAME=project_name docker-compose up -d&lt;/span&gt;
&lt;span class=&quot;gp&quot;&gt;$ &lt;/span&gt;docker-compose up -d
&lt;span class=&quot;c&quot;&gt;#查看启动容器列表&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#例如:COMPOSE_PROJECT_NAME=project_name docker-compose ps&lt;/span&gt;
&lt;span class=&quot;gp&quot;&gt;$ &lt;/span&gt;docker-compose ps

Name                   Command               State                     Ports
---------------------------------------------------------------------------------------------------
zktest_zoo1_1   /docker-entrypoint.sh zkSe ...   Up      0.0.0.0:2181-&amp;gt;2181/tcp, 2888/tcp, 3888/tcp
zktest_zoo2_1   /docker-entrypoint.sh zkSe ...   Up      0.0.0.0:2182-&amp;gt;2181/tcp, 2888/tcp, 3888/tcp
zktest_zoo3_1   /docker-entrypoint.sh zkSe ...   Up      0.0.0.0:2183-&amp;gt;2181/tcp, 2888/tcp, 3888/tcp
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;
&lt;span class=&quot;gp&quot;&gt;$ &lt;/span&gt;docker run -it -d --rm &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
        --link zoo1:zk1 &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
        --link zoo2:zk2 &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
        --link zoo3:zk3 &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
        --net zktest_default &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
        zookeeper zkCli.sh -server zk1:2181,zk2:2181,zk3:2181

&lt;span class=&quot;gp&quot;&gt;$ &lt;/span&gt;zkCLI -server localhost:2181,localhost:2182,localhost:2183

&lt;span class=&quot;c&quot;&gt;#hostname -i查询服务器ip&lt;/span&gt;
&lt;span class=&quot;gp&quot;&gt;$ &lt;/span&gt;hostname -i
192.168.186.40

&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

切换到客户端,查看集群状态
&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;gp&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo &lt;/span&gt;stat | nc 127.0.0.1 2181
Zookeeper version: 3.4.10-39d3a4f269333c922ed3db283be479f9deacaa0f, built on 03/23/2017 10:13 GMT
Clients:
 /192.168.186.27:53356[0]&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;queued&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;0,recved&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;1,sent&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;0&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

Latency min/avg/max: 0/6/53
Received: 26
Sent: 25
Connections: 1
Outstanding: 0
Zxid: 0x40000000a
Mode: follower
Node count: 4

&lt;span class=&quot;gp&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo &lt;/span&gt;stat | nc 127.0.0.1 2182

Zookeeper version: 3.4.10-39d3a4f269333c922ed3db283be479f9deacaa0f, built on 03/23/2017 10:13 GMT
Clients:
 /172.18.0.5:40178[1]&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;queued&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;0,recved&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;47,sent&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;47&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
 /192.168.186.27:53364[0]&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;queued&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;0,recved&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;1,sent&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;0&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

Latency min/avg/max: 0/0/8
Received: 49
Sent: 48
Connections: 2
Outstanding: 0
Zxid: 0x40000000b
Mode: leader
Node count: 4

&lt;span class=&quot;gp&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo &lt;/span&gt;stat | nc 192.168.186.40 2183

Zookeeper version: 3.4.10-39d3a4f269333c922ed3db283be479f9deacaa0f, built on 03/23/2017 10:13 GMT
Clients:
 /192.168.186.27:53365[0]&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;queued&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;0,recved&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;1,sent&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;0&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

Latency min/avg/max: 0/2/14
Received: 8
Sent: 7
Connections: 1
Outstanding: 0
Zxid: 0x40000000b
Mode: follower
Node count: 4
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
</description>
        <pubDate>Sat, 01 Apr 2017 00:00:00 +0800</pubDate>
        <link>http://localhost:4000/2017/04/01/Ubuntu-install-Zookeeper/</link>
        <guid isPermaLink="true">http://localhost:4000/2017/04/01/Ubuntu-install-Zookeeper/</guid>
        
        <category>Guide</category>
        
        
        <category>Ubuntu</category>
        
        <category>Zookeeper</category>
        
      </item>
    
      <item>
        <title>How to write a count down</title>
        <description>&lt;ul id=&quot;markdown-toc&quot;&gt;
  &lt;li&gt;&lt;a href=&quot;#code&quot; id=&quot;markdown-toc-code&quot;&gt;Code&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

There are 2 ways for count down in javascript

&lt;ul&gt;
  &lt;li&gt;setTimeout&lt;/li&gt;
  &lt;li&gt;setInterval&lt;/li&gt;
&lt;/ul&gt;

But them are not accurate for long time count down and sometimes not works well if the user update their PC time.

Below is the accurate implementation which from author &lt;code class=&quot;highlighter-rouge&quot;&gt;Gaohaoyang&lt;/code&gt; the guy works at T-mall.

&lt;h2 id=&quot;code&quot;&gt;Code&lt;/h2&gt;

&lt;div class=&quot;language-js highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;cm&quot;&gt;/**
 * @param  {Number} endTime
 * @param  {Number} deviceTime
 * @param  {Number} serverTime
 * @return {Object}
 */&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;getRemainTime&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;endTime&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;deviceTime&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;serverTime&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;t&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;endTime&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;Date&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;parse&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;Date&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;serverTime&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;deviceTime&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;seconds&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;Math&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;floor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;t&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;60&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;minutes&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;Math&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;floor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;t&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1000&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;60&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;60&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;hours&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;Math&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;floor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;t&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1000&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;60&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;60&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;24&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;days&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;Math&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;floor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;t&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1000&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;60&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;60&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;24&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;s1&quot;&gt;'total'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;s1&quot;&gt;'days'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;days&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;s1&quot;&gt;'hours'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;hours&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;s1&quot;&gt;'minutes'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;minutes&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;s1&quot;&gt;'seconds'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;seconds&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;div class=&quot;language-js highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nx&quot;&gt;getServerTime&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;serverTime&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;

    &lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;intervalTimer&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;setInterval&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;

        &lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;remainTime&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;getRemainTime&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;endTime&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;deviceTime&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;serverTime&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;remainTime&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;total&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;7200000&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;remainTime&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;total&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;c1&quot;&gt;// do something&lt;/span&gt;

        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;remainTime&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;total&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;nx&quot;&gt;clearInterval&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;intervalTimer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
            &lt;span class=&quot;c1&quot;&gt;// do something&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;},&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;})&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
</description>
        <pubDate>Fri, 01 Jul 2016 00:00:00 +0800</pubDate>
        <link>http://localhost:4000/2016/07/01/how-to-write-a-count-down/</link>
        <guid isPermaLink="true">http://localhost:4000/2016/07/01/how-to-write-a-count-down/</guid>
        
        <category>issues</category>
        
        
        <category>javascript</category>
        
      </item>
    
      <item>
        <title>Ubuntu安装JDK</title>
        <description>&lt;ul id=&quot;markdown-toc&quot;&gt;
  &lt;li&gt;&lt;a href=&quot;#ubuntu安装openjdk-或-oralcejdk&quot; id=&quot;markdown-toc-ubuntu安装openjdk-或-oralcejdk&quot;&gt;Ubuntu安装OpenJDK 或 OralceJDK&lt;/a&gt;    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;#安装openjdk&quot; id=&quot;markdown-toc-安装openjdk&quot;&gt;安装OpenJDK&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#安装oracle-jdk&quot; id=&quot;markdown-toc-安装oracle-jdk&quot;&gt;安装Oracle JDK&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#通过bin包安装&quot; id=&quot;markdown-toc-通过bin包安装&quot;&gt;通过bin包安装&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h1 id=&quot;ubuntu安装openjdk-或-oralcejdk&quot;&gt;Ubuntu安装OpenJDK 或 OralceJDK&lt;/h1&gt;

&lt;blockquote&gt;
  打开终端后查看是否安装
java -version
&lt;/blockquote&gt;

&lt;h5 id=&quot;安装openjdk&quot;&gt;安装OpenJDK&lt;/h5&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;#使用下面命令行安装,不需要额外配置环境变量&lt;/span&gt;
sudo apt-get install default-jre
sudo apt-get install default-jdk
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;blockquote&gt;
  更多软件版本用下列查询命令
&lt;/blockquote&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;sudo apt-cache search jre
sudo apt-cache search jdk
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;h5 id=&quot;安装oracle-jdk&quot;&gt;安装Oracle JDK&lt;/h5&gt;

&lt;blockquote&gt;
  如果想安装java7,替换掉命令中java8即可
命令行安装依赖网络环境
&lt;/blockquote&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;#使用下面命令行安装,不需要额外配置环境变量&lt;/span&gt;
sudo add-apt-repository ppa:webupd8team/java
sudo apt-get update
sudo apt-get install oracle-java8-installer
sudo apt-get install oracle-java8-set-default

&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;h5 id=&quot;通过bin包安装&quot;&gt;通过bin包安装&lt;/h5&gt;
&lt;blockquote&gt;
  这种方式需要配置环境变量
&lt;a href=&quot;http://www.oracle.com/technetwork/java/javase/downloads/jdk8-downloads-2133151.html&quot;&gt;从官网下载对应tar包&lt;/a&gt;
&lt;/blockquote&gt;

如下载后文件为&lt;code class=&quot;highlighter-rouge&quot;&gt;jdk-8u101-linux-x64.tar.gz&lt;/code&gt;
使用如下命令解压:

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;sudo tar zxvf ./jdk-8u101-linux-x64.tar.gz
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
为了方便管理,请将解压后的文件夹短命名然后移至到你的统一包管理文件夹内
例如:&lt;code class=&quot;highlighter-rouge&quot;&gt;/usr/java/jdk1.8/&lt;/code&gt;

编辑文件 &lt;code class=&quot;highlighter-rouge&quot;&gt;~/.bashrc&lt;/code&gt; 配置java环境变量

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;JAVA_HOME&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/usr/java/jdk1.8/
&lt;span class=&quot;nv&quot;&gt;JRE_HOME&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$JAVA_HOME&lt;/span&gt;/jre
&lt;span class=&quot;nv&quot;&gt;JAVA_BIN&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$JAVA_HOME&lt;/span&gt;/bin
&lt;span class=&quot;nv&quot;&gt;CLASSPATH&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;.:&lt;span class=&quot;nv&quot;&gt;$JAVA_HOME&lt;/span&gt;/lib/dt.jar:&lt;span class=&quot;nv&quot;&gt;$JAVA_HOME&lt;/span&gt;/lib/tools.jar:&lt;span class=&quot;nv&quot;&gt;$JRE_HOME&lt;/span&gt;/lib
&lt;span class=&quot;nv&quot;&gt;PATH&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$PATH&lt;/span&gt;:&lt;span class=&quot;nv&quot;&gt;$JAVA_HOME&lt;/span&gt;/bin:&lt;span class=&quot;nv&quot;&gt;$JRE_HOME&lt;/span&gt;/bin
&lt;span class=&quot;nb&quot;&gt;export &lt;/span&gt;JAVA_HOME JRE_HOME PATH CLASSPATH
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

如果使用命令行源安装,默认安装路径为&lt;code class=&quot;highlighter-rouge&quot;&gt;/usr/lib/jvm/xxxxx&lt;/code&gt;
修改JAVA_HOME路径为对应路径即可

使用下面命令使配置及时生效

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nb&quot;&gt;source&lt;/span&gt; ~/.bashrc
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
最后再次使用下面命令验证配置是否生效

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;java -version
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
</description>
        <pubDate>Thu, 05 May 2016 00:00:00 +0800</pubDate>
        <link>http://localhost:4000/2016/05/05/Ubuntu-install-JDK/</link>
        <guid isPermaLink="true">http://localhost:4000/2016/05/05/Ubuntu-install-JDK/</guid>
        
        <category>Guide</category>
        
        
        <category>Ubuntu</category>
        
        <category>java</category>
        
      </item>
    
      <item>
        <title>Ubuntu安装Docker</title>
        <description>&lt;ul id=&quot;markdown-toc&quot;&gt;
  &lt;li&gt;&lt;a href=&quot;#ubuntu安装docker&quot; id=&quot;markdown-toc-ubuntu安装docker&quot;&gt;Ubuntu安装Docker&lt;/a&gt;    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;#安装最新稳定版&quot; id=&quot;markdown-toc-安装最新稳定版&quot;&gt;安装最新稳定版&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#开机启动&quot; id=&quot;markdown-toc-开机启动&quot;&gt;开机启动&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#常用命令&quot; id=&quot;markdown-toc-常用命令&quot;&gt;常用命令&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#安装docker-compose&quot; id=&quot;markdown-toc-安装docker-compose&quot;&gt;安装Docker Compose&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h1 id=&quot;ubuntu安装docker&quot;&gt;Ubuntu安装Docker&lt;/h1&gt;
容器技术现在火的不得了,可移植性强,docker库中有很多成熟的官方容器可以拿来就用,对硬件条件有限切网架设多种服务的人来说,非常吸引人.

&lt;h4 id=&quot;安装最新稳定版&quot;&gt;安装最新稳定版&lt;/h4&gt;
&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;#安装依赖包&lt;/span&gt;
&lt;span class=&quot;gp&quot;&gt;$ &lt;/span&gt;sudo apt-get install &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
    apt-transport-https &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
    ca-certificates &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
    curl &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
    software-properties-common

&lt;span class=&quot;gp&quot;&gt;$ &lt;/span&gt;sudo apt-get install &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
    linux-image-extra-&lt;span class=&quot;k&quot;&gt;$(&lt;/span&gt;uname -r&lt;span class=&quot;k&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
    linux-image-extra-virtual

&lt;span class=&quot;gp&quot;&gt;$ &lt;/span&gt;curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo apt-key add -
&lt;span class=&quot;c&quot;&gt;#Verify that the key fingerprint is 9DC8 5822 9FC7 DD38 854A E2D8 8D81 803C 0EBF CD88.&lt;/span&gt;
&lt;span class=&quot;gp&quot;&gt;$ &lt;/span&gt;sudo apt-key fingerprint 0EBFCD88

pub   4096R/0EBFCD88 2017-02-22
      Key fingerprint &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 9DC8 5822 9FC7 DD38 854A  E2D8 8D81 803C 0EBF CD88
uid                  Docker Release &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;CE deb&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &amp;lt;docker@docker.com&amp;gt;
sub   4096R/F273FCD8 2017-02-22
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;code class=&quot;highlighter-rouge&quot;&gt;amd64:&lt;/code&gt;
&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;gp&quot;&gt;$ &lt;/span&gt;sudo add-apt-repository &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
   &lt;span class=&quot;s2&quot;&gt;&quot;deb [arch=amd64] https://download.docker.com/linux/ubuntu &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;
   &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;$(&lt;/span&gt;lsb_release -cs&lt;span class=&quot;k&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;
   stable&quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;code class=&quot;highlighter-rouge&quot;&gt;armhf:&lt;/code&gt;
&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;gp&quot;&gt;$ &lt;/span&gt;sudo add-apt-repository &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
   &lt;span class=&quot;s2&quot;&gt;&quot;deb [arch=armhf] https://download.docker.com/linux/ubuntu &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;
   &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;$(&lt;/span&gt;lsb_release -cs&lt;span class=&quot;k&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;
   stable&quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
卸载Docker

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;sudo apt-get purge docker-ce

&lt;span class=&quot;c&quot;&gt;#Images, containers, volumes, or customized configuration files on your host are not automatically removed. To delete all images, containers, and volumes:&lt;/span&gt;
&lt;span class=&quot;gp&quot;&gt;$ &lt;/span&gt;sudo rm -rf /var/lib/docker
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

如果上面命令无效,请参考&lt;a href=&quot;https://store.docker.com/editions/community/docker-ce-server-ubuntu?tab=description&quot;&gt;官网最新命令&lt;/a&gt;安装CE版本

&lt;h4 id=&quot;开机启动&quot;&gt;开机启动&lt;/h4&gt;
&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;sudo systemctl &lt;span class=&quot;nb&quot;&gt;enable &lt;/span&gt;docker
&lt;span class=&quot;c&quot;&gt;#关闭&lt;/span&gt;
sudo systemctl disable docker

&lt;span class=&quot;c&quot;&gt;#切换手动启动&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;echo &lt;/span&gt;manual | sudo tee /etc/init/docker.override
&lt;span class=&quot;c&quot;&gt;#切换自动自动&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;echo &lt;/span&gt;upstart | sudo tee /etc/init/docker.override
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;h4 id=&quot;常用命令&quot;&gt;常用命令&lt;/h4&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;#查看容器日志&lt;/span&gt;
docker logs -f &amp;lt;容器名orID&amp;gt;
&lt;span class=&quot;c&quot;&gt;#查看正在运行的容器&lt;/span&gt;
docker ps
docker ps -a为查看所有的容器，包括已经停止的
&lt;span class=&quot;c&quot;&gt;#删除所有容器&lt;/span&gt;
docker rm &lt;span class=&quot;k&quot;&gt;$(&lt;/span&gt;docker ps -a -q&lt;span class=&quot;k&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#删除单个容器&lt;/span&gt;
docker rm &amp;lt;容器名orID&amp;gt;
&lt;span class=&quot;c&quot;&gt;#停止、启动、杀死一个容器&lt;/span&gt;
docker stop &amp;lt;容器名orID&amp;gt;
docker start &amp;lt;容器名orID&amp;gt;
docker &lt;span class=&quot;nb&quot;&gt;kill&lt;/span&gt; &amp;lt;容器名orID&amp;gt;
&lt;span class=&quot;c&quot;&gt;#查看所有镜像&lt;/span&gt;
docker images
&lt;span class=&quot;c&quot;&gt;#删除所有镜像&lt;/span&gt;
docker rmi &lt;span class=&quot;k&quot;&gt;$(&lt;/span&gt;docker images | grep none | awk &lt;span class=&quot;s1&quot;&gt;'{print $3}'&lt;/span&gt; | sort -r&lt;span class=&quot;k&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#拉取镜像&lt;/span&gt;
docker pull &amp;lt;镜像名:tag&amp;gt;
&lt;span class=&quot;c&quot;&gt;#镜像迁移&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#机器A&lt;/span&gt;
docker save busybox-1 &amp;gt; /home/save.tar
&lt;span class=&quot;c&quot;&gt;#机器B&lt;/span&gt;
docker load &amp;lt; /home/save.tar
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;h4 id=&quot;安装docker-compose&quot;&gt;安装Docker Compose&lt;/h4&gt;
&lt;a href=&quot;https://docs.docker.com/compose/install/&quot;&gt;官网地址&lt;/a&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;gp&quot;&gt;$ &lt;/span&gt;sudo curl -L &lt;span class=&quot;s2&quot;&gt;&quot;https://github.com/docker/compose/releases/download/1.11.2/docker-compose-&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;$(&lt;/span&gt;uname -s&lt;span class=&quot;k&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;$(&lt;/span&gt;uname -m&lt;span class=&quot;k&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt; -o /usr/local/bin/docker-compose

&lt;span class=&quot;gp&quot;&gt;$ &lt;/span&gt;sudo chmod +x /usr/local/bin/docker-compose

&lt;span class=&quot;gp&quot;&gt;$ &lt;/span&gt;docker-compose --version

docker-compose version 1.11.2, build dfed245

&lt;span class=&quot;c&quot;&gt;#移除&lt;/span&gt;
&lt;span class=&quot;gp&quot;&gt;$ &lt;/span&gt;rm /usr/local/bin/docker-compose

&lt;span class=&quot;c&quot;&gt;#升级到指定版本替换下面migrate-to-labels&lt;/span&gt;
&lt;span class=&quot;gp&quot;&gt;$ &lt;/span&gt;docker-compose migrate-to-labels
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

pip方式安装

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;gp&quot;&gt;$ &lt;/span&gt;sudo pip install -U docker-compose
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
</description>
        <pubDate>Mon, 01 Jun 2015 00:00:00 +0800</pubDate>
        <link>http://localhost:4000/2015/06/01/Ubuntu-install-docker/</link>
        <guid isPermaLink="true">http://localhost:4000/2015/06/01/Ubuntu-install-docker/</guid>
        
        <category>Guide</category>
        
        
        <category>Ubuntu</category>
        
        <category>Docker</category>
        
      </item>
    
  </channel>
</rss>
